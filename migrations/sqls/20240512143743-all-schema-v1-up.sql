/* Replace with your SQL commands */
GRANT ALL PRIVILEGES ON DATABASE project2 TO full_stack_user;
GRANT ALL PRIVILEGES ON DATABASE project2_test TO full_stack_user;

CREATE TABLE PRODUCTS
(
    id       INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name     VARCHAR(50),
    price    INTEGER,
    category VARCHAR(20)
);

CREATE TABLE USERS
(
    id        INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username  VARCHAR(50) UNIQUE,
    firstname VARCHAR(20),
    lastname  VARCHAR(50),
    password  VARCHAR
);

CREATE TABLE ORDERS
(
    id      INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    user_id INTEGER,
    status  VARCHAR(10),
    CONSTRAINT FK_ORDERS_USERs FOREIGN KEY (user_id) REFERENCES USERS (id)
);

CREATE TABLE ORDER_DETAILS
(
    id         INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    order_id   INTEGER,
    product_id INTEGER,
    quantity   INTEGER,
    CONSTRAINT FK_DETAILS_ORDERS FOREIGN KEY (order_id) REFERENCES ORDERS (id),
    CONSTRAINT FK_DETAILS_PRODUCTS FOREIGN KEY (product_id) REFERENCES PRODUCTS (id)
);

TRUNCATE PRODUCTS RESTART IDENTITY CASCADE;
TRUNCATE USERS RESTART IDENTITY CASCADE;
TRUNCATE ORDERS RESTART IDENTITY CASCADE;
TRUNCATE ORDER_DETAILS RESTART IDENTITY CASCADE;
INSERT INTO USERS (username, firstname, lastname, password)
VALUES ('revir216', 'Nugyen', 'Mihn Cud', 'check');
INSERT INTO ORDERS (user_id, status)
VALUES (1, 'done');
INSERT INTO PRODUCTS(name, price, category)
VALUES ('Bridge to Terabithia', 250, 'Book');
INSERT INTO ORDER_DETAILS (order_id, product_id, quantity)
VALUES (1, 1, 5)
